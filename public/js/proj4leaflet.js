!function(t){var o,i;if("function"==typeof define&&define.amd)define(["leaflet","proj4"],t);else if("object"==typeof module&&"object"==typeof module.exports)o=require("leaflet"),i=require("proj4"),module.exports=t(o,i);else{if(void 0===window.L||void 0===window.proj4)throw"Leaflet and proj4 must be loaded first";t(window.L,window.proj4)}}(function(l,e){return e.__esModule&&e.default&&(e=e.default),l.Proj={},l.Proj._isProj4Obj=function(t){return void 0!==t.inverse&&void 0!==t.forward},l.Proj.Projection=l.Class.extend({initialize:function(t,o,i){var e=l.Proj._isProj4Obj(t);this._proj=e?t:this._projFromCodeDef(t,o),this.bounds=e?o:i},project:function(t){var o=this._proj.forward([t.lng,t.lat]);return new l.Point(o[0],o[1])},unproject:function(t,o){var i=this._proj.inverse([t.x,t.y]);return new l.LatLng(i[1],i[0],o)},_projFromCodeDef:function(t,o){if(o)e.defs(t,o);else if(void 0===e.defs[t]){var i=t.split(":");if(3<i.length&&(t=i[i.length-3]+":"+i[i.length-1]),void 0===e.defs[t])throw"No projection definition for code "+t}return e(t)}}),l.Proj.CRS=l.Class.extend({includes:l.CRS,options:{transformation:new l.Transformation(1,0,-1,0)},initialize:function(t,o,i){var e,s,n,r;if(l.Proj._isProj4Obj(t)?(e=(s=t).srsCode,r=o||{},this.projection=new l.Proj.Projection(s,r.bounds)):(e=t,n=o,r=i||{},this.projection=new l.Proj.Projection(e,n,r.bounds)),l.Util.setOptions(this,r),this.code=e,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new l.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var a=this.options.resolutions.length-1;0<=a;a--)this.options.resolutions[a]&&(this._scales[a]=1/this.options.resolutions[a])}this.infinite=!this.options.bounds},scale:function(t){var o,i=Math.floor(t);return t===i?this._scales[t]:(o=this._scales[i])+(this._scales[i+1]-o)*(t-i)},zoom:function(t){var o,i,e=this._closestElement(this._scales,t),s=this._scales.indexOf(e);return t===e?s:void 0===e?-1/0:(i=s+1,void 0===(o=this._scales[i])?1/0:(t-e)/(o-e)+s)},distance:l.CRS.Earth.distance,R:l.CRS.Earth.R,_closestElement:function(t,o){for(var i,e=t.length;e--;)t[e]<=o&&(void 0===i||i<t[e])&&(i=t[e]);return i}}),l.Proj.GeoJSON=l.GeoJSON.extend({initialize:function(t,o){this._callLevel=0,l.GeoJSON.prototype.initialize.call(this,t,o)},addData:function(t){var i;t&&(t.crs&&"name"===t.crs.type?i=new l.Proj.CRS(t.crs.properties.name):t.crs&&t.crs.type&&(i=new l.Proj.CRS(t.crs.type+":"+t.crs.properties.code)),void 0!==i&&(this.options.coordsToLatLng=function(t){var o=l.point(t[0],t[1]);return i.projection.unproject(o)})),this._callLevel++;try{l.GeoJSON.prototype.addData.call(this,t)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}}),l.Proj.geoJson=function(t,o){return new l.Proj.GeoJSON(t,o)},l.Proj.ImageOverlay=l.ImageOverlay.extend({initialize:function(t,o,i){l.ImageOverlay.prototype.initialize.call(this,t,null,i),this._projectedBounds=o},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),i=l.point(this._projectedBounds.min.x,this._projectedBounds.max.y),e=this._projectedToNewLayerPoint(i,t.zoom,t.center);l.DomUtil.setTransform(this._image,e,o)},_reset:function(){var t=this._map.getZoom(),o=this._map.getPixelOrigin(),i=l.bounds(this._transform(this._projectedBounds.min,t)._subtract(o),this._transform(this._projectedBounds.max,t)._subtract(o)),e=i.getSize();l.DomUtil.setPosition(this._image,i.min),this._image.style.width=e.x+"px",this._image.style.height=e.y+"px"},_projectedToNewLayerPoint:function(t,o,i){var e=this._map.getSize()._divideBy(2),s=this._map.project(i,o)._subtract(e)._round().add(this._map._getMapPanePos());return this._transform(t,o)._subtract(s)},_transform:function(t,o){var i=this._map.options.crs,e=i.transformation,s=i.scale(o);return e.transform(t,s)}}),l.Proj.imageOverlay=function(t,o,i){return new l.Proj.ImageOverlay(t,o,i)},l.Proj});