L.GridLayer.DebugCoords=L.GridLayer.extend({createTile:function(e){var r=document.createElement("div");return r.innerHTML=[e.x,e.y-1,e.z].join(", "),r}}),L.gridLayer.debugCoords=function(e){return new L.GridLayer.DebugCoords(e)},map.addLayer(L.gridLayer.debugCoords({tileSize:250})),L.GridLayer.Lidar=L.GridLayer.extend({createTile:function(e,o){var d=document.createElement("canvas"),r=this.getTileSize();d.setAttribute("width",r.x),d.setAttribute("height",r.y);var l=d.getContext("2d"),L=e.x,c=Math.abs(e.y)-1,u=performance.now();return fetch("/lidar?lat="+L+"&lon="+c).then(function(e){return e.json()}).then(function(e){var r=performance.now();console.log("Fetch "+L+c+" took "+(r-u)/1e3+" seconds.");for(var t=e.data,n=0;n<t.length;n++)for(var a=t[n],i=0;i<a.length;i++)a[i]<0&&(a[i]=0),l.fillStyle="rgba(0,0,0,"+a[i]/100+")",l.fillRect(i,n,1,1);o(null,d)}).catch(function(e){console.log(e)}),d}}),L.gridLayer.lidar=function(e){return new L.GridLayer.Lidar(e)},map.addLayer(L.gridLayer.lidar({tileSize:250}));
